/*!
 * 
 *  maishu-dilu v1.9.1
 *  https://github.com/ansiboy/dilu
 *  
 *  Copyright (c) 2016-2018, shu mai <ansiboy@163.com>
 *  Licensed under the MIT License.
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.dilu=t():e.dilu=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var l=t[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,r),l.l=!0,l.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)r.d(n,l,function(t){return e[t]}.bind(null,l));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./out/index.js")}({"./out/errors.js":
/*!***********************!*\
  !*** ./out/errors.js ***!
  \***********************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errors=void 0,t.errors={argumentNull:e=>new Error(`Parameter ${e} can not be null or empty.`),elementValidateRuleNotSet(e){let t=`元素'${e.name}'没有设置验证规则`;return new Error(t)},fieldElementCanntNull:e=>new Error(null!=e?`The element value in the field cannt be null, field index is ${e}.`:"The element in the field is null"),elementNotExists:e=>new Error(`Element ${e} is not exits in the form.`),fieldResultExpectBooleanType:e=>new Error(`Result of ${e} field is expected boolean.`)}},"./out/formValidator.js":
/*!******************************!*\
  !*** ./out/formValidator.js ***!
  \******************************/
/*! no static exports found */function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(l,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?l(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,s)}a((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.FormValidator=void 0;const l=r(/*! ./errors */"./out/errors.js");class i{constructor(e,...t){if(this.validateOnChanged=!0,!e)throw l.errors.argumentNull("form");this.fields=t||[],this.form=e,this.elementEvents={}}appendField(e){this.fields.push(e)}clearErrors(){this.fields.map(e=>e.errorElement).filter(e=>null!=e).forEach(e=>e.style.display="none")}clearElementError(e){if(!e)throw l.errors.argumentNull("name");let t=this.fields.filter(t=>t.name==e);for(let e of t){this.fieldErrorElement(e).style.display="none"}}setElementError(e,t){if(!e)throw l.errors.argumentNull("name");if(!t)throw l.errors.argumentNull("error");let r=this.fields.filter(t=>t.name==e);for(let e of r){let r=this.fieldErrorElement(e);r.style.removeProperty("display"),r.innerHTML=t}}fieldElement(e){let t=e.name,r=this.form.querySelectorAll(`[name='${t}']`)[0];if(null==r)throw l.errors.elementNotExists(t);return r}fieldErrorElement(e){if(!e.errorElement){let t=this.form.getElementsByClassName(`${i.errorClassName} ${e.name}`)[0];if(!t){let r=this.fieldElement(e);(t=document.createElement("span")).className=i.errorClassName,t.style.display="none",r.nextSibling?r.parentElement.insertBefore(t,r.nextSibling):r.parentElement.appendChild(t)}e.errorElement=t}return e.errorElement}check(){let e=new Array;for(let t=0;t<this.fields.length;t++){let r=this.fields[t],n=this.fieldElement(r);if(r.condition&&0==r.condition(n))continue;let l=this.checkField(r);e.push(l)}return 0==e.filter(e=>0==e).length}checkAsync(){return n(this,void 0,void 0,function*(){let e=new Array;for(let t=0;t<this.fields.length;t++){let r=this.fields[t],n=this.fieldElement(r);if(r.condition&&0==r.condition(n))continue;let l=this.checkFieldAsync(r);e.push(l)}return 0==(yield Promise.all(e)).filter(e=>0==e).length})}bindElementEvent(e,t){if(this.elementEvents[e.name])return;let r=this.fieldElement(e),n=(()=>{let r=!1;return()=>{r||(r=!0,t?this.checkFieldAsync(e).then(()=>r=!1).catch(()=>r=!1):(this.checkField(e),r=!1))}})();if(this.validateOnChanged){r.addEventListener("change",n);let e=r.type||"text";if("text"==e||"password"==e)r.addEventListener("keyup",n);else if("radio"==e){let e=r.name,t=this.form.querySelectorAll(`[name='${e}']`);for(let e=0;e<t.length;e++)t[e]!=r&&t[e].addEventListener("change",n)}}this.elementEvents[e.name]=!0}checkField(e){this.bindElementEvent(e,!1);let t=this.fieldElement(e),r=e.depends||[];for(let e=0;e<r.length;e++){let n=r[e](t);if("object"==typeof n)throw new Error("Please use checkAsync method.");if(!n)return!1}for(let t=0;t<e.rules.length;t++){let r=e.rules[t],n=this.fieldElement(e);if(null==n)throw l.errors.fieldElementCanntNull();let i=this.elementValue(n),o=r.validate(i);if("object"==typeof o)throw new Error("Please use checkAsync method.");if(this.showElement(!o,e,r,n),!o)return!1}return!0}checkFieldAsync(e){return n(this,void 0,void 0,function*(){this.bindElementEvent(e,!0);let t=this.fieldElement(e),r=e.depends||[];for(let e=0;e<r.length;e++){let n=r[e](t);if("boolean"==typeof n&&(n=Promise.resolve(n)),!(yield n))return!1}for(let t=0;t<e.rules.length;t++){let r=e.rules[t],n=this.fieldElement(e);if(null==n)throw l.errors.fieldElementCanntNull();let i=this.elementValue(n),o=r.validate(i);"boolean"==typeof o&&(o=Promise.resolve(o));let s=yield o;if(this.showElement(!s,e,r,n),!s)return!1}return!0})}showElement(e,t,r,n){let l=this.fieldErrorElement(t);if(console.assert(null!=l,"errorElement cannt be null."),null!=r.error){l=t.errorElement;let e=this.elementName(n),i="string"==typeof r.error?r.error:r.error()||"";l.innerHTML=i.replace("%s",e)}e?l.style.removeProperty("display"):l.style.display="none"}checkElementAsync(e){let t=this.fields.filter(t=>t.name==e)[0];if(!t)throw l.errors.elementNotExists(e);return this.checkFieldAsync(t)}checkElement(e){let t=this.fields.filter(t=>t.name==e)[0];if(!t)throw l.errors.elementNotExists(e);return this.checkField(t)}elementValue(e){if("TEXTAREA"==e.tagName)return e.value;let t=e;if("radio"==t.type){let e=this.form.querySelectorAll(`[name='${t.name}']`);for(let t=0;t<e.length;t++)if(e[t].checked)return e[t].value;return""}return e.value}elementName(e){return e.tagName,e.name}}t.FormValidator=i,i.errorClassName="validationMessage"},"./out/index.js":
/*!**********************!*\
  !*** ./out/index.js ***!
  \**********************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rules=t.FormValidator=void 0;var n=r(/*! ./formValidator */"./out/formValidator.js");Object.defineProperty(t,"FormValidator",{enumerable:!0,get:function(){return n.FormValidator}});var l=r(/*! ./rules */"./out/rules.js");Object.defineProperty(t,"rules",{enumerable:!0,get:function(){return l.rules}}),r(/*! ./style */"./out/style.js")},"./out/rules.js":
/*!**********************!*\
  !*** ./out/rules.js ***!
  \**********************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rules=void 0;var n=/^[0-9]+$/,l=/^\-?[0-9]*\.?[0-9]+$/,i=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,o=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,s=/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,a=/^1[34578]\d{9}$/,u=/\d{4}-\d{1,2}-\d{1,2}/;let d="%s不能为空",f="%s与%s不匹配",c="%s和%s必须相同",m="%s至少包含%s个字符",h="The %s field must contain a number greater than %s.",p="The %s field must contain a number less than %s.",y="请数入数字",E="The %s field must contain a valid IP.",v="The %s field must contain a valid URL.",g="请输入正确的手机号码",b="请输入正确制";function w(e,t){return{validate:e,error:t}}function j(e){return"function"==typeof e?e():e}function x(e,t){let r;return(r="number"==typeof t?l.test(e)?parseFloat(e):null:"string"==typeof t?e:function(e){if(!e.match("today")&&!e.match(u))return null;var t,r=new Date;e.match("today")||(t=e.split("-"),r.setFullYear(t[0]),r.setMonth(t[1]-1),r.setDate(t[2]));return r}(e))<t?"lessThan":r>t?"greaterThan":"equal"}t.rules={required:e=>w(e=>""!=(e||""),e||d),matches:(e,t)=>w(t=>t==e.value,t||d),email:e=>w(e=>i.test(e),e||d),minLength:(e,t)=>w(t=>(t||"").length>=j(e),t||m),maxLength:(e,t)=>w(t=>(t||"").length<=j(e),t||f),greaterThan:(e,t)=>w(t=>"greaterThan"==x(t,j(e)),t||h),lessThan:(e,t)=>w(t=>"lessThan"==x(t,j(e)),t||p),equal:(e,t)=>w(t=>"equal"==x(t,j(e)),t||c),ip:e=>w(e=>o.test(e),e||E),url:e=>w(e=>s.test(e),e||v),mobile:e=>w(e=>a.test(e),e||g),numeric:e=>w(e=>n.test(e),e||y),custom:(e,t)=>w(e,t||b)}},"./out/style.js":
/*!**********************!*\
  !*** ./out/style.js ***!
  \**********************/
/*! no static exports found */function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(/*! ./formValidator */"./out/formValidator.js");if(!document.getElementById("maishu-dilu-style")&&null!=document.head){let e=document.createElement("style");e.type="text/css",e.id="maishu-dilu-style",document.head.appendChild(e),e.innerHTML=`\n    .${n.FormValidator.errorClassName} {\n        color: red;\n        font-weight: bold;\n    }\n    `}}})});
//# sourceMappingURL=index.min.js.map